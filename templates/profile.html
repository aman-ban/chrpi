{% extends "base.html" %}

{% block title %}@{{ profile.username }}'s Profile{% endblock %}

{% block content %}
<div class="container py-4">
    <div class="profile-header">
        <img src="{{ profile.profile_image if profile.profile_image else url_for('static', filename='default-profile.png') }}"
             alt="{{ profile.username }}" class="profile-image-large">

        <h1 class="page-title">@{{ profile.username }}</h1>
        <p class="profile-bio">{{ profile.bio if profile.bio else "A cheerful new chrpi user!" }}</p>

        {% if user %}

            {% if user.id != profile.id %}
                <form method="POST" action="{{ url_for('follow', user_id=profile.id) if not is_following else url_for('unfollow', user_id=profile.id) }}" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

                    <button type="submit" class="btn {% if is_following %}btn-secondary{% else %}btn-primary{% endif %}">
                        {% if is_following %}
                            Unfollow
                        {% else %}
                            Follow {{ profile.username }}
                        {% endif %}
                    </button>
                </form>
            {% else %}
                <a href="{{ url_for('edit_profile') }}" class="btn btn-secondary">
                    Edit Your Profile
                </a>
            {% endif %}

        {% endif %}
    </div>

    <hr>

    <h2>{{ profile.username }}'s Posts</h2>

    <div class="post-list">
        {% for post in posts %}
            {% include 'post_card_template.html' %}
        {% else %}
            <p class="text-muted">No posts shared yet.</p>
        {% endfor %}
    </div>

</div>
{% endblock %}