{% extends "base.html" %}

{% block title %}@{{ profile.username }}'s Profile{% endblock %}

{% block content %}

<div class="profile-page-container">

    <div class="profile-card">
        <div class="profile-avatar-section">
            <img src="{{ profile.profile_image if profile.profile_image else url_for('static', filename='default-profile.png') }}"
                 alt="{{ profile.username }}"
                 class="profile-avatar-large">
        </div>

        <h1 class="profile-name">@{{ profile.username }}</h1>
        <p class="profile-bio-text">{{ profile.bio if profile.bio else "A cheerful new chrpi user!" }}</p>

        <div class="profile-actions">
            {% if user %}
                {% if user.id != profile.id %}
                    <form method="POST"
                          action="{{ url_for('follow', user_id=profile.id) if not is_following else url_for('unfollow', user_id=profile.id) }}"
                          class="profile-follow-form">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>
                        <button type="submit" class="btn {% if is_following %}btn-secondary{% else %}btn-primary{% endif %}">
                            {% if is_following %}
                                ‚úì Following
                            {% else %}
                                + Follow
                            {% endif %}
                        </button>
                    </form>
                {% else %}
                    <a href="{{ url_for('edit_profile') }}" class="btn btn-secondary">
                        ‚úèÔ∏è Edit Profile
                    </a>
                {% endif %}
            {% endif %}
        </div>
    </div>

    <div class="profile-posts-section">
        <h3 class="profile-posts-title">{{ profile.username }}'s Posts</h3>

        <div class="post-list">
            {% if posts %}
                {% for post in posts %}
                    {% include 'post_card_template.html' %}
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-state-emoji">üìù</div>
                    <h3>No posts yet</h3>
                    <p>
                        {% if user and user.id == profile.id %}
                            Share your first uplifting story!
                        {% else %}
                            {{ profile.username }} hasn't shared anything yet.
                        {% endif %}
                    </p>
                    {% if user and user.id == profile.id %}
                        <a href="{{ url_for('create_post') }}" class="btn btn-primary">
                            Create Your First Post
                        </a>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>

</div>

{% endblock %}