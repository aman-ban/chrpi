{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<h1 class="page-title">{{ title }}</h1>

<div class="post-list">
    {% if not posts %}
        <div class="text-center p-5">
            <p class="fs-4 text-muted">No posts have received any smiles yet!</p>
        </div>
    {% endif %}

    {% for post in posts %}
    <div class="post-card">
        <div class="post-body">

            <a href="{{ url_for('view_single_post', post_id=post.id) }}" class="text-decoration-none">

                {% if post.content %}
                    <p class="post-content-text">{{ post.content }}</p>
                {% endif %}

                {% if post.link %}
                    <p>
                        <a href="{{ post.link }}" target="_blank" class="story-link">
                            ğŸ”— View External Story
                        </a>
                    </p>
                {% endif %}

            </a>

            {% if post.image %}
                <img src="{{ post.image }}" class="post-image" alt="Post image">
            {% endif %}

            <div class="d-flex justify-content-between align-items-center mt-3">

                <div class="post-meta">
                    Posted by
                    <a href="{{ url_for('user_profile', username=post.username) }}">@{{ post.username }}</a>
                    â€” {{ post.timestamp }}
                </div>

                <form action="{{ url_for('smile', post_id=post.id) }}" method="POST" style="display:inline;">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}"/>

                    <button type="submit" class="btn btn-smile {% if post.has_smiled %}btn-smile-active{% endif %}">
                        {% if post.has_smiled %}
                            ğŸ˜Š Smiled ({{ post.smiles }})
                        {% else %}
                            ğŸ˜ Smile? ({{ post.smiles }})
                        {% endif %}
                    </button>
                </form>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}